## 基本概念

### 事务支持

事务是指作为单个逻辑工作单元执行的一系列操作，具有ACID特性：

- **原子性(Atomicity)**：事务中的所有操作要么全部完成，要么全部不完成
- **一致性(Consistency)**：事务执行前后数据库都保持一致性状态
- **隔离性(Isolation)**：并发事务之间互不干扰
- **持久性(Durability)**：事务完成后对数据的修改是永久性的

简单来说，也就是在一次完整的事务中，如果出现了某一个 sql 语句执行失败，整个事务就会回滚，具体到每一个引擎如下表所示。

| 存储引擎    | 事务支持 | 语句失败时的行为                                       |
| :---------- | :------- | :----------------------------------------------------- |
| **InnoDB**  | 支持     | 自动回滚整个事务（包括之前已成功的语句）               |
| **MyISAM**  | 不支持   | 已执行的语句会立即生效，失败语句不执行，不存在回滚概念 |
| **Memory**  | 不支持   | 同MyISAM                                               |
| **Archive** | 不支持   | 同MyISAM                                               |

### 锁粒度

锁的基本类型

- **表级锁**：锁定整张表，简单来说就是进行查询操作的时候会自动对整个表加读锁，进行数据修改操作的时候自动对整个表加写锁，此时其他的语句操作会被阻塞。
- **行级锁**：只锁定正在操作的行，其他的行仍然可以被并发访问。

### 外键支持

外键就是关系型数据库的一种约束机制

## 主要引擎

### InnoDB（重点）

1. 支持事务，行级锁，外键
2. 适用场景为需要高并发性能的 OLTP 应用

### MyISAM（重点）

1. 不支持事务，外键，使用的是表级锁
2. 适合读取密集型应用，例如数据仓库，因为读取性能较快

### Memory

1. 数据存储在内存中，速度快，但是服务器重启后数据会消失
2. 适用场景为临时表和数据缓存

### NDB

1. 支持高可用型和数据分布
2. 行级锁和自动分区

### Archive

1. 不支持索引
2. 主要适用于存储大量的历史数据，因为支持高效的压缩和插入

| 存储引擎    | 事务支持 | 锁粒度 | 外键支持 | 主要特点                 |      适用场景      |
| :---------- | :------- | :----- | :------- | :----------------------- | :----------------: |
| **InnoDB**  | 支持     | 行锁   | 支持     | 数据缓存，聚簇索引，MVCC | 事务处理，高并发写 |
| **MyISAM**  | 不支持   | 表锁   | 不支持   | 高性能读取               | 读密集型，数据仓库 |
| **Memory**  | 不支持   | 表锁   | 不支持   | 内存存储，极快           |    临时表，缓存    |
| **NDB**     | 支持     | 行锁   | 支持     | 高可用，实时性能         |     分布式应用     |
| **Archive** | 不支持   | 行锁   | 不支持   | 高压缩比，只支持插入查询 |      日志归档      |

